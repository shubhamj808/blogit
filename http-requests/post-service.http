### Blogit Post Service API Tests
### Base URL: http://localhost:8082/api

### Variables
@baseUrl = http://localhost:8082/api
@gatewayUrl = http://localhost:8080/api
@authToken = 
@postId = 

### 1. Health Check
GET {{baseUrl}}/../actuator/health

### 2. Create New Post
POST {{baseUrl}}/posts
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "title": "Getting Started with Spring Boot",
  "content": "Spring Boot is a powerful framework that makes it easy to create stand-alone, production-grade Spring-based applications...",
  "excerpt": "Learn the basics of Spring Boot framework",
  "tags": ["spring-boot", "java", "programming"],
  "category": "PROGRAMMING",
  "published": true
}

> {%
client.test("Post created successfully", function() {
    client.assert(response.status === 201, "Response status is not 201");
    client.global.set("postId", response.body.id);
});
%}

### 3. Get All Posts (Public)
GET {{baseUrl}}/posts?page=0&size=10&sort=createdAt,desc

### 4. Get Posts by Category
GET {{baseUrl}}/posts?category=PROGRAMMING&page=0&size=10

### 5. Search Posts
GET {{baseUrl}}/posts/search?query=spring&page=0&size=10

### 6. Get Post by ID
GET {{baseUrl}}/posts/{{postId}}

### 7. Update Post
PUT {{baseUrl}}/posts/{{postId}}
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "title": "Getting Started with Spring Boot - Updated",
  "content": "Spring Boot is a powerful framework that makes it easy to create stand-alone, production-grade Spring-based applications. This updated content includes more examples...",
  "excerpt": "Learn the basics of Spring Boot framework with practical examples",
  "tags": ["spring-boot", "java", "programming", "tutorial"],
  "category": "PROGRAMMING",
  "published": true
}

### 8. Get Posts by User
GET {{baseUrl}}/posts/user/1?page=0&size=10
Authorization: Bearer {{authToken}}

### 9. Get User's Own Posts
GET {{baseUrl}}/posts/my?page=0&size=10
Authorization: Bearer {{authToken}}

### 10. Get Popular Posts
GET {{baseUrl}}/posts/popular?page=0&size=10

### 11. Get Posts by Tags
GET {{baseUrl}}/posts/tags?tags=spring-boot,java&page=0&size=10

### 12. Save Post as Draft
POST {{baseUrl}}/posts
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "title": "Understanding Microservices Architecture",
  "content": "Microservices architecture is a design pattern...",
  "excerpt": "An introduction to microservices",
  "tags": ["microservices", "architecture", "design-patterns"],
  "category": "PROGRAMMING",
  "published": false
}

### 13. Get User's Draft Posts
GET {{baseUrl}}/posts/my?published=false&page=0&size=10
Authorization: Bearer {{authToken}}

### 14. Publish Draft Post
PATCH {{baseUrl}}/posts/{{postId}}/publish
Authorization: Bearer {{authToken}}

### 15. Unpublish Post
PATCH {{baseUrl}}/posts/{{postId}}/unpublish
Authorization: Bearer {{authToken}}

### 16. Like Post
POST {{baseUrl}}/posts/{{postId}}/like
Authorization: Bearer {{authToken}}

### 17. Unlike Post
DELETE {{baseUrl}}/posts/{{postId}}/like
Authorization: Bearer {{authToken}}

### 18. Get Post Likes
GET {{baseUrl}}/posts/{{postId}}/likes?page=0&size=10

### 19. Comment on Post
POST {{baseUrl}}/posts/{{postId}}/comments
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "content": "Great article! Very helpful for beginners."
}

### 20. Get Post Comments
GET {{baseUrl}}/posts/{{postId}}/comments?page=0&size=10

### 21. Update Comment
PUT {{baseUrl}}/comments/1
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "content": "Great article! Very helpful for beginners learning Spring Boot."
}

### 22. Delete Comment
DELETE {{baseUrl}}/comments/1
Authorization: Bearer {{authToken}}

### 23. Get All Categories
GET {{baseUrl}}/categories

### 24. Get All Tags
GET {{baseUrl}}/tags?page=0&size=20

### 25. Delete Post
DELETE {{baseUrl}}/posts/{{postId}}
Authorization: Bearer {{authToken}}

### ===== VIA API GATEWAY =====

### 26. Create Post via Gateway
POST {{gatewayUrl}}/posts
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "title": "Microservices with Spring Cloud",
  "content": "Building microservices with Spring Cloud provides powerful tools...",
  "excerpt": "Learn microservices development with Spring Cloud",
  "tags": ["spring-cloud", "microservices", "java"],
  "category": "PROGRAMMING",
  "published": true
}

### 27. Get Posts via Gateway
GET {{gatewayUrl}}/posts?page=0&size=10

### 28. Search Posts via Gateway
GET {{gatewayUrl}}/posts/search?query=microservices&page=0&size=10

### 29. Like Post via Gateway
POST {{gatewayUrl}}/posts/1/like
Authorization: Bearer {{authToken}}

### 30. Comment via Gateway
POST {{gatewayUrl}}/posts/1/comments
Authorization: Bearer {{authToken}}
Content-Type: application/json

{
  "content": "Excellent explanation of microservices architecture!"
}
